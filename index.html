<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KreaByte - Mantenimiento Programado</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');

        /* Oculta la barra de desplazamiento horizontal que podría aparecer durante el juego */
        .game-area {
            position: relative;
            overflow: hidden;
            background-color: #000000; /* Fondo del juego en negro puro */
            border-radius: 0.75rem; 
            border: 1px solid #10b981; /* Borde verde para destacar */
        }

        /* Estilo para la línea del suelo */
        #dinoGameCanvas {
            display: block;
            touch-action: manipulation; /* Permite el tap para saltar en móviles */
        }

        /* --- ESTILOS PARA EL EFECTO DE PARTÍCULAS (NEÓN PULSANTE) --- */
        /* COLOR: VERDE NEÓN BRILLANTE (#A3E635 / lime-400) */
        .neon-text {
            color: #ffffff; /* Color de la fuente blanco */
            font-weight: 800;
            text-shadow: 
                0 0 7px #a3e635, /* Brillo verde */
                0 0 10px #a3e635,
                0 0 20px #a3e635; 
            animation: neon-pulse 2.5s infinite alternate; /* Animación de pulsación */
        }

        /* Define la animación de pulsación */
        @keyframes neon-pulse {
            0% {
                opacity: 0.9;
                transform: scale(1);
            }
            100% {
                opacity: 1;
                transform: scale(1.02);
            }
        }
        /* --- FIN ESTILOS PARTÍCULAS --- */
    </style>
</head>
<body class="bg-gray-900 text-gray-100 flex items-center justify-center min-h-screen p-4">

    <main class="bg-gray-800 w-full max-w-lg rounded-xl shadow-2xl p-8 md:p-10 border-t-8 border-lime-500">

        <!-- Saludo Dinámico y Hora Actual -->
        <div class="text-center mb-6">
            <!-- Colores ajustados para modo oscuro y verde neón -->
            <p id="greeting" class="text-xl font-semibold text-lime-400"></p>
            <p id="current-time" class="text-sm text-gray-400 mt-1"></p>
        </div>

        <div class="text-center">
            <!-- Título Principal con efecto de Neón (Verde) -->
            <h1 class="text-4xl neon-text mb-4">¡Estamos en Mantenimiento!</h1>
            <!-- Color de texto ajustado para modo oscuro -->
            <p class="text-lg text-gray-300">Mientras optimizamos el servicio, ¿por qué no juegas un poco?</p>
        </div>

        <!-- Área del Mini Juego del Dinosaurio -->
        <!-- Fondo ajustado a negro puro (#000000) -->
        <div class="mt-8 shadow-inner game-area h-72 flex items-center justify-center">
            <!-- Canvas donde se dibuja el juego -->
            <canvas id="dinoGameCanvas" width="512" height="288" class="w-full h-full"></canvas>

            <!-- Mensaje de inicio (se oculta al empezar el juego) -->
            <div id="startMessage" class="absolute inset-0 bg-black/50 flex flex-col items-center justify-center z-50 transition-opacity duration-300">
                <p class="text-xl font-bold text-white mb-4">Juego de Mantenimiento</p>
                
                <!-- BOTÓN DE INICIO DE JUEGO -->
                <button 
                    id="startButton"
                    onclick="startGame()"
                    class="px-6 py-3 bg-lime-500 text-gray-900 font-extrabold text-lg rounded-full shadow-lg hover:bg-lime-400 transition duration-150 transform hover:scale-105 active:scale-95 border-2 border-lime-300"
                >
                    EMPEZAR JUEGO
                </button>
                
                <p class="text-xs text-gray-400 mt-4">También puedes usar la tecla ESPACIO o hacer TOCA en la pantalla.</p>
            </div>
        </div>

        <!-- Detalles del Horario (ahora debajo del juego para no interferir) -->
        <!-- Fondo ajustado a un gris oscuro (gray-700) -->
        <div class="mt-4 text-center bg-gray-700 p-4 rounded-lg shadow-md max-w-sm mx-auto">
            <!-- Colores ajustados para modo oscuro y verde neón -->
            <h2 class="text-xl font-bold text-lime-300 mb-2">Mantenimiento volveremos en breve </h2>
        </div>

        <div class="mt-8 text-center text-base text-gray-300">
            <p>Disculpa las molestias. Volvemos en línea muy pronto con un mejor rendimiento. ¡Gracias por tu paciencia!</p>
        </div>
    </main>

    <script>
        // --- LÓGICA DEL SALUDO Y TIEMPO ---
        function updateTimeAndGreeting() {
            const now = new Date();
            const hour = now.getHours();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', timeZoneName: 'short' };
            const timeString = now.toLocaleTimeString('es-ES', options);
            
            let greetingText = '';

            if (hour >= 5 && hour < 12) {
                greetingText = 'Buenos días';
            } else if (hour >= 12 && hour < 19) {
                greetingText = 'Buenas tardes';
            } else {
                greetingText = 'Buenas noches';
            }

            document.getElementById('greeting').textContent = greetingText + ',';
            document.getElementById('current-time').textContent = 'Tu hora local es: ' + timeString;
        }

        // --- LÓGICA DEL JUEGO (DISCO DURO VS VIRUS) ---

        const canvas = document.getElementById('dinoGameCanvas');
        const ctx = canvas.getContext('2d');
        const startMessage = document.getElementById('startMessage');

        // Variables del Juego
        let isGameRunning = false;
        let isJumping = false;
        let verticalVelocity = 0;
        const gravity = 0.9; // REDUCIDA (Fácil)
        const jumpStrength = 18; // AUMENTADA (Fácil)
        let score = 0;
        let healthPoints = 3; // Puntos de vida iniciales
        const MAX_HEALTH = 5; // Puntos de vida máximos
        let gameSpeed = 5;
        let obstacles = [];
        let collectibles = []; // Nuevos coleccionables (Avast)
        let frameCount = 0;
        let groundLevelY = 0; 

        // Propiedades del Disco Duro (Player)
        const dino = { 
            width: 40, 
            height: 40, 
            x: 50,
            y: 0 
        };

        // Función de inicialización y reseteo
        function initGame() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            groundLevelY = canvas.height - dino.height; 
            
            dino.y = groundLevelY;
            isGameRunning = false;
            isJumping = false;
            verticalVelocity = 0;
            score = 0;
            healthPoints = 3; // Resetear salud
            gameSpeed = 5;
            obstacles = [];
            collectibles = [];
            frameCount = 0;

            drawInitialScreen();
        }

        // Dibuja la pantalla inicial o de "Game Over"
        function drawInitialScreen(gameOver = false) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawGround();

            if (gameOver || !isGameRunning) {
                startMessage.classList.remove('opacity-0', 'pointer-events-none');
                startMessage.classList.add('opacity-100');
            } else {
                startMessage.classList.remove('opacity-100');
                startMessage.classList.add('opacity-0', 'pointer-events-none'); 
            }
            
            if (gameOver) {
                // Dibujar el Disco Duro chocado (rojo)
                drawDino('#f87171');

                ctx.fillStyle = '#a3e635'; // Verde Neón para el texto de Game Over
                ctx.font = 'bold 30px Inter';
                ctx.textAlign = 'center';
                ctx.fillText('¡SISTEMA CRASH!', canvas.width / 2, canvas.height / 2 - 20); 
                
                ctx.font = '16px Inter';
                ctx.fillText(`Virus Evadidos: ${score}`, canvas.width / 2, canvas.height / 2 + 10);
                
                ctx.font = '14px Inter';
                ctx.fillText('Presiona ESPACIO/TOCA para reiniciar', canvas.width / 2, canvas.height / 2 + 40);

            } else {
                // Dibujar el Disco Duro en reposo
                drawDino('#a3e635');
            }
        }


        // Inicia el juego y oculta el mensaje
        function startGame() {
            if (!isGameRunning) {
                startMessage.classList.remove('opacity-100');
                startMessage.classList.add('opacity-0', 'pointer-events-none'); 
                
                initGame(); 
                isGameRunning = true;
                gameLoop();
            }
        }

        // --- Dibujo de Elementos ---

        function drawDino(color) {
            const x = dino.x;
            const y = dino.y;
            const w = dino.width;
            const h = dino.height;

            // 1. Cuerpo principal del Disco Duro (caja rectangular)
            ctx.fillStyle = '#94a3b8'; // Gris oscuro para la carcasa
            ctx.fillRect(x, y, w, h);

            // 2. Tapa/Plato (círculo interior)
            ctx.fillStyle = '#475569'; // Gris más oscuro para el plato
            ctx.beginPath();
            ctx.arc(x + w * 0.4, y + h * 0.5, w * 0.3, 0, Math.PI * 2);
            ctx.fill();

            // 3. LED de actividad (el color actual indica si está chocado o normal)
            ctx.fillStyle = color; // Usar el color del juego (neón o rojo)
            ctx.fillRect(x + w * 0.8, y + h * 0.1, w * 0.1, h * 0.1); 
        }

        // Dibuja el obstáculo base (Virus)
        function drawVirus(obstacle) {
            const x = obstacle.x;
            const y = obstacle.y;
            const w = obstacle.width;
            const h = obstacle.height;

            ctx.fillStyle = '#10b981'; 
            // Cuerpo del virus (círculo simple)
            ctx.beginPath();
            ctx.arc(x + w / 2, y + h / 2, Math.min(w, h) / 2, 0, Math.PI * 2);
            ctx.fill();

            // Dibujar picos/antenas
            ctx.fillRect(x + w / 0.8, y + h * 0.4, w * 0.1, h * 0.2); 
            ctx.fillRect(x - w * 0.1, y + h * 0.4, w * 0.1, h * 0.2); 
            ctx.fillRect(x + w * 0.4, y - h * 0.1, w * 0.2, h * 0.1); 
            
            // Dibujar núcleo rojo
            ctx.fillStyle = '#f87171'; // Rojo de advertencia
            ctx.fillRect(x + w * 0.4, y + h * 0.4, w * 0.2, h * 0.2);
        }

        // Dibuja el obstáculo Troyano (Caja de regalo maliciosa)
        function drawTrojan(obstacle) {
            const x = obstacle.x;
            const y = obstacle.y;
            const w = obstacle.width;
            const h = obstacle.height;

            ctx.fillStyle = '#f97316'; // Naranja (peligro)
            // Caja
            ctx.fillRect(x, y, w, h);
            
            // Lazo (amarillo)
            ctx.fillStyle = '#facc15'; 
            ctx.fillRect(x + w * 0.4, y, w * 0.2, h);
            ctx.fillRect(x, y + h * 0.4, w, h * 0.2);
            
            // Calavera (mini-advertencia)
            ctx.fillStyle = '#000000';
            ctx.beginPath();
            ctx.arc(x + w * 0.5, y + h * 0.5, w * 0.1, 0, Math.PI * 2);
            ctx.fill();
        }

        // Dibuja el obstáculo Bomba Lógica (Cuadrado con mecha)
        function drawLogicBomb(obstacle) {
            const x = obstacle.x;
            const y = obstacle.y;
            const w = obstacle.width;
            const h = obstacle.height;

            ctx.fillStyle = '#dc2626'; // Rojo oscuro (bomba)
            // Caja bomba
            ctx.fillRect(x, y, w, h);

            // Mecha (palo gris)
            ctx.fillStyle = '#4b5563'; 
            ctx.fillRect(x + w * 0.8, y - h * 0.1, w * 0.05, h * 0.2);

            // Chispas/fuego (amarillo)
            ctx.fillStyle = '#facc15'; 
            ctx.fillRect(x + w * 0.8, y - h * 0.1, w * 0.15, h * 0.05);

            // Detalle (negro)
            ctx.fillStyle = '#000000';
            ctx.fillRect(x + w * 0.2, y + h * 0.3, w * 0.6, h * 0.4);
        }

        function drawObstacle(obstacle) {
            switch (obstacle.type) {
                case 'trojan':
                    drawTrojan(obstacle);
                    break;
                case 'bomb':
                    drawLogicBomb(obstacle);
                    break;
                case 'virus':
                default:
                    drawVirus(obstacle);
                    break;
            }
        }
        
        // Dibuja el coleccionable (Avast/Medicina)
        function drawAvast(item) {
            const x = item.x;
            const y = item.y;
            const size = item.width;
            
            ctx.fillStyle = '#3b82f6'; // Azul (Antivirus)
            
            // Píldora (rectángulo redondeado)
            ctx.beginPath();
            ctx.moveTo(x + size * 0.2, y);
            ctx.lineTo(x + size * 0.8, y);
            ctx.arcTo(x + size, y, x + size, y + size * 0.2, size * 0.2);
            ctx.lineTo(x + size, y + size * 0.8);
            ctx.arcTo(x + size, y + size, x + size * 0.8, y + size, size * 0.2);
            ctx.lineTo(x + size * 0.2, y + size);
            ctx.arcTo(x, y + size, x, y + size * 0.8, size * 0.2);
            ctx.lineTo(x, y + size * 0.2);
            ctx.arcTo(x, y, x + size * 0.2, y, size * 0.2);
            ctx.closePath();
            ctx.fill();

            // Cruz (+) blanca
            ctx.fillStyle = '#ffffff';
            ctx.fillRect(x + size * 0.45, y + size * 0.2, size * 0.1, size * 0.6);
            ctx.fillRect(x + size * 0.2, y + size * 0.45, size * 0.6, size * 0.1);
        }


        function drawGround() {
            // Línea de suelo en verde sólido (representa la línea de seguridad o el escritorio)
            ctx.strokeStyle = '#34d399'; 
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(0, canvas.height - 1);
            ctx.lineTo(canvas.width, canvas.height - 1);
            ctx.stroke();
        }

        function drawScore() {
            ctx.fillStyle = '#a3e635'; // Texto de puntaje en Verde Neón
            ctx.font = '16px Inter';
            ctx.textAlign = 'right';
            ctx.fillText('Virus Evadidos: ' + score, canvas.width - 20, 30); 
        }
        
        function drawHealth() {
            ctx.fillStyle = '#ffffff';
            ctx.font = '16px Inter';
            ctx.textAlign = 'left';
            ctx.fillText('Salud:', 20, 30);
            
            // Dibuja la barra de salud
            const barX = 75;
            const barY = 15;
            const barWidth = 100;
            const barHeight = 15;
            
            // Fondo de la barra (máxima salud)
            ctx.fillStyle = '#374151'; // Gris oscuro
            ctx.fillRect(barX, barY, barWidth, barHeight);
            
            // Salud actual
            const currentHealthWidth = (healthPoints / MAX_HEALTH) * barWidth;
            
            // Color de la barra basado en la salud
            if (healthPoints > 2) {
                ctx.fillStyle = '#4ade80'; // Verde brillante
            } else if (healthPoints === 2) {
                ctx.fillStyle = '#facc15'; // Amarillo
            } else {
                ctx.fillStyle = '#ef4444'; // Rojo (peligro)
            }
            
            ctx.fillRect(barX, barY, currentHealthWidth, barHeight);

            // Borde
            ctx.strokeStyle = '#a3e635';
            ctx.lineWidth = 1;
            ctx.strokeRect(barX, barY, barWidth, barHeight);
        }

        // --- Lógica del Juego ---

        function jump() {
            if (!isGameRunning) {
                return;
            }
            if (!isJumping) {
                isJumping = true;
                verticalVelocity = -jumpStrength;
            }
        }

        function handleDinoMovement() {
            if (isJumping) {
                verticalVelocity += gravity; 
                dino.y += verticalVelocity;

                if (dino.y >= groundLevelY) {
                    dino.y = groundLevelY;
                    isJumping = false;
                    verticalVelocity = 0;
                }
            }
        }

        function spawnObstacle() {
            // Configuración de aparición fácil (de 100 a 140 frames)
            let spawnRange = 100; 
            
            if (score > 30) {
                 spawnRange = 70; 
            } else if (score > 15) {
                spawnRange = 85; 
            }

            // Aumentar la variedad de enemigos a medida que sube el puntaje
            let obstacleTypes = ['virus'];
            if (score > 10) obstacleTypes.push('trojan');
            if (score > 25) obstacleTypes.push('bomb');


            if (frameCount % (Math.floor(Math.random() * 40) + spawnRange) === 0) { 
                const typeIndex = Math.floor(Math.random() * obstacleTypes.length);
                const type = obstacleTypes[typeIndex];
                
                const virusHeight = 25 + Math.random() * 20; 
                
                const obstacle = {
                    type: type,
                    width: 25 + Math.random() * 10, 
                    height: virusHeight, 
                    x: canvas.width,
                    y: groundLevelY + (dino.height - virusHeight),
                    isHit: false // Flag para prevenir doble choque
                };

                obstacles.push(obstacle);
            }
        }
        
        function spawnCollectible() {
             // Aparece un Avast entre 300 y 600 frames (mucho menos frecuente que los obstáculos)
            if (frameCount % (Math.floor(Math.random() * 300) + 300) === 0) {
                const itemSize = 20;
                const item = {
                    type: 'avast',
                    width: itemSize,
                    height: itemSize,
                    x: canvas.width,
                    // Aparece flotando en el aire (no en el suelo)
                    y: groundLevelY - Math.floor(Math.random() * 50) - 20, 
                    isCollected: false
                };
                collectibles.push(item);
            }
        }

        function isColliding(a, b) {
            return (
                a.x < b.x + b.width &&
                a.x + a.width > b.x &&
                a.y < b.y + b.height &&
                a.y + a.height > b.y
            );
        }


        function handleObstacles() {
            for (let i = 0; i < obstacles.length; i++) {
                const obstacle = obstacles[i];
                obstacle.x -= gameSpeed; // Mueve el obstáculo a la izquierda
                drawObstacle(obstacle); 

                // --- Detección de Colisión (Obstáculos) ---
                if (isColliding(dino, obstacle) && !obstacle.isHit) {
                    // ¡Colisión!
                    obstacle.isHit = true; // Marca como golpeado para no restar vida de nuevo
                    healthPoints--; // Resta un punto de vida
                    
                    if (healthPoints <= 0) {
                        isGameRunning = false;
                        drawInitialScreen(true);
                        return;
                    }
                }

                // Eliminar obstáculos que están fuera de la pantalla
                if (obstacle.x + obstacle.width < 0) {
                    obstacles.splice(i, 1);
                    i--; // Ajustar el índice
                    score++; // Aumenta el puntaje por cada virus evadido (o golpeado y pasado)
                }
            }
            // Aumentar la velocidad del juego más lentamente
            gameSpeed += 0.005; 
        }
        
        function handleCollectibles() {
            for (let i = 0; i < collectibles.length; i++) {
                const item = collectibles[i];
                item.x -= gameSpeed; // Mueve el Avast a la izquierda
                drawAvast(item);

                // --- Detección de Recolección ---
                if (isColliding(dino, item) && !item.isCollected) {
                    // ¡Recolectado!
                    item.isCollected = true;
                    
                    if (healthPoints < MAX_HEALTH) {
                        healthPoints++; // Suma un punto de vida (Avast)
                    }
                    
                    // Eliminar Avast después de recolectar
                    collectibles.splice(i, 1);
                    i--; 
                    continue;
                }
                
                // Eliminar Avast que están fuera de la pantalla
                if (item.x + item.width < 0) {
                    collectibles.splice(i, 1);
                    i--; // Ajustar el índice
                }
            }
        }

        // Bucle Principal del Juego
        function gameLoop() {
            if (!isGameRunning) return;

            // 1. Limpiar Canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // 2. Ocultar el mensaje 
            startMessage.classList.remove('opacity-100');
            startMessage.classList.add('opacity-0', 'pointer-events-none'); 

            // 3. Dibujar Suelo
            drawGround();

            // 4. Manejar el Disco Duro (Movimiento y Dibujo)
            handleDinoMovement();
            drawDino('#a3e635'); 

            // 5. Manejar Virus/Troyanos/Bombas (Generación, Movimiento y Colisión)
            spawnObstacle();
            handleObstacles();
            
            // 6. Manejar Avast (Generación, Movimiento y Colisión)
            spawnCollectible();
            handleCollectibles();

            // 7. Dibujar Puntaje
            drawScore();
            
            // 8. Dibujar Salud
            drawHealth();

            frameCount++;
            
            requestAnimationFrame(gameLoop);
        }

        // --- Eventos de Entrada ---

        // Teclado (ESPACIO)
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault(); 
                if (!isGameRunning) {
                    startGame();
                } else {
                    jump();
                }
            }
        });

        // Click/Touch para Saltar 
        canvas.addEventListener('click', () => {
             if (isGameRunning) {
                jump();
            }
        });

        // Asegurar que el canvas se redimensione y se inicialice correctamente al cargar la página
        window.addEventListener('load', () => {
            updateTimeAndGreeting();
            setInterval(updateTimeAndGreeting, 60000); 
            initGame();
        });

        // Redimensionar el canvas si la ventana cambia de tamaño
        window.addEventListener('resize', initGame);

    </script>
</body>
</html>
